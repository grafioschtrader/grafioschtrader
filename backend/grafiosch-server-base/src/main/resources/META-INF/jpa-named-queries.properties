MailSendRecv.deleteByIdReplyToLocalAndIdUser=DELETE FROM mail_send_recv WHERE id_reply_to_local = ?1 AND (id_user_to = ?2 AND send_recv = "R" OR id_user_from = ?2 AND send_recv = "S")
MailSendRecv.deleteByIdMailSendRecvAndIdUser=DELETE FROM mail_send_recv WHERE id_mail_send_recv = ?1 AND (id_user_to = ?2 AND send_recv = "R" OR id_user_from = ?2 AND send_recv = "S") 
MailSendRecv.findByUserOrGroup=SELECT msr2.id_mail_send_recv AS idMailSendRecv, msr2.send_recv AS sendRecv, msr2.id_user_from AS idUserFrom, msr2.id_user_to AS idUserTo, msr2.id_role_to AS idRoleTo, msr2.id_gt_net idGtNet, msr2.subject, message, msr2.id_reply_to_local AS idReplyToLocal, msr2.id_reply_to_remote AS idReplyToRemote, msr2.reply_to_role_private AS replyToRolePrivate, msr2.send_recv_time AS sendRecvTime, md.has_been_read AS hasBeenRead, r.rolename AS roleNameTo FROM ( SELECT msr1.* FROM mail_send_recv msr1 LEFT JOIN user_role ur ON ur.id_role = msr1.id_role_to JOIN user u ON u.id_user = ur.id_user WHERE u.id_user = ?1 AND msr1.id_role_to IS NOT NULL AND msr1.send_recv = "R" AND msr1.send_recv_time >= u.last_role_modified_time UNION SELECT msr.* FROM mail_send_recv msr, user u WHERE (msr.id_user_from = u.id_user AND msr.send_recv = "S" OR msr.id_user_to = u.id_user AND msr.send_recv = "R") AND u.id_user = ?1 UNION SELECT msr2.* FROM mail_send_recv msr2, user u WHERE msr2.id_reply_to_local IN ( SELECT msr1.id_reply_to_local FROM mail_send_recv msr1 LEFT JOIN user_role ur ON ur.id_role = msr1.id_role_to JOIN user u ON u.id_user = ur.id_user WHERE msr1.send_recv = "R" AND msr1.id_role_to IS NOT NULL AND u.id_user = ?1) AND (msr2.send_recv = "R" AND msr2.reply_to_role_private = 0 OR msr2.send_recv = "S" AND msr2.reply_to_role_private = 1) AND msr2.id_user_from <> ?1 AND msr2.id_user_to <> ?1 AND msr2.reply_to_role_private < 2 AND u.id_user = ?1 AND msr2.send_recv_time >= u.last_role_modified_time) AS msr2 LEFT JOIN mail_send_recv_read_del md ON msr2.id_mail_send_recv = md.id_mail_send_recv AND md.id_user = ?1 LEFT JOIN role r ON msr2.id_role_to = r.id_role WHERE md.mark_hide_del IS NULL OR md.mark_hide_del = 0 ORDER BY msr2.id_mail_send_recv   
MailSendRecv.countRoleSend=SELECT msr1.id_reply_to_local AS idReplyToLocal, COUNT(*) AS numberOfAnswer FROM mail_send_recv msr1 WHERE msr1.id_reply_to_local IN ( SELECT msr.id_reply_to_local FROM mail_send_recv msr WHERE msr.send_recv = "R" AND msr.id_reply_to_local IS NOT NULL AND msr.id_role_to IN (SELECT ur.id_role FROM user_role ur JOIN user u ON u.id_user = ur.id_user AND u.id_user = ?1)) AND msr1.send_recv = "S" GROUP BY msr1.id_reply_to_local
MailSendRecvReadDel.markforDelGroup=INSERT INTO mail_send_recv_read_del(id_user, id_mail_send_recv, has_been_read, mark_hide_del) SELECT ?1, m.id_mail_send_recv, 0, 1 FROM (SELECT msr1.id_mail_send_recv   FROM mail_send_recv msr1 LEFT JOIN user_role ur ON ur.id_role = msr1.id_role_to JOIN user u ON u.id_user = ur.id_user WHERE u.id_user = ?1 AND msr1.id_role_to IS NOT NULL AND msr1.send_recv = "R" AND msr1.send_recv_time >= u.last_role_modified_time AND msr1.id_reply_to_local = ?2 UNION SELECT msr.id_mail_send_recv FROM mail_send_recv msr, user u WHERE (msr.id_user_from = u.id_user AND msr.send_recv = "S" OR msr.id_user_to = u.id_user AND msr.send_recv = "R") AND u.id_user = ?1 AND msr.id_reply_to_local = ?2 UNION SELECT msr2.id_mail_send_recv FROM mail_send_recv msr2, user u WHERE msr2.id_reply_to_local IN ( SELECT msr1.id_reply_to_local FROM mail_send_recv msr1 LEFT JOIN user_role ur ON ur.id_role = msr1.id_role_to JOIN user u ON u.id_user = ur.id_user WHERE msr1.send_recv = "R" AND msr1.id_role_to IS NOT NULL AND u.id_user = ?1) AND (msr2.send_recv = "R" AND msr2.reply_to_role_private = 0 OR msr2.send_recv = "S" AND msr2.reply_to_role_private = 1) AND msr2.id_user_from <> ?1 AND msr2.id_user_to <> ?1 AND msr2.reply_to_role_private < 2 AND u.id_user = ?1 AND msr2.send_recv_time >= u.last_role_modified_time AND msr2.id_reply_to_local = ?2) AS m ON DUPLICATE KEY UPDATE mark_hide_del = 1

GTNet.findPushOpenSuppliers=SELECT DISTINCT g.* FROM gt_net g JOIN gt_net_entity e ON g.id_gt_net = e.id_gt_net JOIN gt_net_config_entity c ON e.id_gt_net_entity = c.id_gt_net_entity WHERE e.entity_kind = 0 AND e.accept_request = 2 AND e.server_state = 1 AND c.consumer_usage > 0 AND g.server_online = 1 AND g.server_busy = 0 ORDER BY c.consumer_usage ASC
GTNet.findOpenSuppliers=SELECT DISTINCT g.* FROM gt_net g JOIN gt_net_entity e ON g.id_gt_net = e.id_gt_net JOIN gt_net_config_entity c ON e.id_gt_net_entity = c.id_gt_net_entity WHERE e.entity_kind = 0 AND e.accept_request = 1 AND e.server_state = 1 AND c.consumer_usage > 0 AND g.server_online = 1 AND g.server_busy = 0 ORDER BY c.consumer_usage ASC
GTNet.findHistoryquotePushOpenSuppliers=SELECT DISTINCT g.* FROM gt_net g JOIN gt_net_entity e ON g.id_gt_net = e.id_gt_net JOIN gt_net_config_entity c ON e.id_gt_net_entity = c.id_gt_net_entity WHERE e.entity_kind = 1 AND e.accept_request = 2 AND e.server_state = 1 AND c.consumer_usage > 0 AND g.server_online = 1 AND g.server_busy = 0 ORDER BY c.consumer_usage ASC
GTNet.findHistoryquoteOpenSuppliers=SELECT DISTINCT g.* FROM gt_net g JOIN gt_net_entity e ON g.id_gt_net = e.id_gt_net JOIN gt_net_config_entity c ON e.id_gt_net_entity = c.id_gt_net_entity WHERE e.entity_kind = 1 AND e.accept_request = 1 AND e.server_state = 1 AND c.consumer_usage > 0 AND g.server_online = 1 AND g.server_busy = 0 ORDER BY c.consumer_usage ASC

UDFMetadataGeneral.countUiOrderAndDescription=SELECT (SELECT COUNT(*) FROM udf_metadata_general ug JOIN udf_metadata u ON ug.id_udf_metadata = u.id_udf_metadata WHERE u.ui_order = ?3 AND u.id_user IN(?1) AND ug.entity = ?2) AS countUiOrder, (SELECT COUNT(*) countDescription FROM udf_metadata_general ug JOIN udf_metadata u ON ug.id_udf_metadata = u.id_udf_metadata WHERE u.description = ?4 AND u.id_user IN (?1) AND ug.entity = ?2) AS countDescription

User.getIdUserAndNicknameByRoleExcludeUser=SELECT u.id_user AS idUser, u.nickname FROM user u JOIN user_role ur ON u.id_user = ur.id_user JOIN role r ON ur.id_role = r.id_role WHERE r.rolename = ?1 AND u.id_user <> ?2 
User.getEmailExcludeWhenMsgComTypeAndTargetTypeExists=SELECT u.email, u.locale FROM user u WHERE NOT EXISTS (SELECT * FROM mail_setting_forward m WHERE m.message_com_type = ?1 AND m.message_target_type = ?2 AND m.id_user = u.id_user) ORDER BY locale
UserEntityChangeCount.getCudTransactionAndUserLimit=SELECT c.count_insert + c.count_update + c.count_delete as cudTrans, l.day_limit as dayLimit FROM user_entity_change_count c LEFT JOIN user_entity_change_limit l on l.id_user = c.id_user AND l.entity_name = c.entity_name AND l.until_date >= CURDATE() WHERE c.id_user = ?1 AND c.date = CURDATE() AND c.entity_name=?2
